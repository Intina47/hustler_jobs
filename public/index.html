<!DOCTYPE html>
<html>
<head>
   <!-- meta -->
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Job Listings</title>
    <!-- font awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <!-- css -->
    <link rel="stylesheet" href="/css/style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/stickybits/3.7.6/stickybits.min.js"></script>


</head>
<body>
    <div class="container">
        <!-- job listing and search bar in the same row -->
        <div class="row">
            <div class="col-md-8">
              <a href="/" style="text-decoration: none;">
                <h1 class="about mb-4" style="display: flex;">Job Listings</h1>
              </a>
            </div>
            <span>
                <a href="search.html">
                  <i class="fa-solid fa-magnifying-glass search_icon"></i>
                </a>
            </span>
          </div>

          <div id="sticky-container" class="sticky">
        <div class="toggle-container">
            <span class="toggle-label">Dark Mode</span>
            <label class="toggle">
                <input class="toggle-checkbox" type="checkbox" id="darkModeToggle">
                <span class="toggle-icon" id="toggleIcon"><i class="fa-solid fa-moon"></i></span>
            </label>
        </div>
      </div>
        <div id="jobListings"></div>
    </div>
    <script>
        //load jobs from jobs.json
        fetch('./jobs')
  .then(function (response) {
    return response.json();
  })
  .then(function (jobs) {
    displayJobs(jobs);
  });

  function displayJobs(jobs) {
    var jobListingsContainer = document.getElementById('jobListings');
    jobs.forEach(function (job) {
      var jobListing = document.createElement('div');
      jobListing.className = 'job-listing';
  
      var jobTitle = document.createElement('div');
      jobTitle.className = 'job-title';
      jobTitle.textContent = job.title;
  
      var jobLink = document.createElement('a');
      jobLink.className = 'job-link';
      jobLink.textContent = 'View Details';
      jobLink.addEventListener('click', function() {
        fetch(`/pdf/${encodeURIComponent(job.file_name)}`)
          .then(function(response) {
            return response.blob();
          })
          .then(function(blob) {
            // Create a temporary URL for the blob object
            var fileUrl = URL.createObjectURL(blob);
            // Open the file in a new tab/window
            window.open(fileUrl);
          });
      });
  
      jobListing.appendChild(jobTitle);
      jobListing.appendChild(jobLink);
  
      jobListingsContainer.appendChild(jobListing);
    });
  }
  




                // Toggle dark mode
        var darkModeToggle = document.getElementById('darkModeToggle');
        var toggleIcon = document.getElementById('toggleIcon');

        darkModeToggle.addEventListener('change', function () {
            if (this.checked) {
                document.body.classList.add('dark-mode');
                toggleIcon.innerHTML = '<i class="fa-solid fa-moon"></i>'; // Moon icon
            } else {
                document.body.classList.remove('dark-mode');
                toggleIcon.innerHTML = '<i class="fa-solid fa-moon"></i>'; // Sun icon
            }
        });

        window.addEventListener('scroll', function() {
    var stickyElement = document.querySelector('.sticky');
    var stickyElementTop = stickyElement.getBoundingClientRect().top;
    
    if (stickyElementTop === 0) {
        stickyElement.classList.add('sticky-background');
    } else {
        stickyElement.classList.remove('sticky-background');
    }
});

      
    </script>

</body>
</html>
